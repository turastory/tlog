{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/snippets/kubeconfig/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Turastory"}},"markdownRemark":{"id":"3027bfb9-fd38-5016-8a27-06a24a5952a5","fields":{"slug":"/snippets/kubeconfig/"},"excerpt":"GitHub Actions를 사용해 배포 스크립트를 작성하다가 kubeconfig 파일에 관한 부분이 헷갈려 정리해보았다. What is kubeconfig kubeconfig 파일은 클러스터, 유저, 네임스페이스, 인증 등 *클러스터 접근에 대한 정보를 담고 있는 파일이다. Where…","html":"<p>GitHub Actions를 사용해 배포 스크립트를 작성하다가 kubeconfig 파일에 관한 부분이 헷갈려 정리해보았다.</p>\n<h3>What is kubeconfig</h3>\n<p>kubeconfig 파일은 클러스터, 유저, 네임스페이스, 인증 등 *<em>클러스터 접근</em>에 대한 정보를 담고 있는 파일이다.</p>\n<h3>Where is it</h3>\n<p>기본적으로는 <code class=\"language-text\">$HOME/.kube/config</code>에 위치한다. 명령을 실행할 때는 디폴트로 이 파일을 사용하고, <code class=\"language-text\">KUBECONFIG</code> 환경 변수를 사용하거나 <code class=\"language-text\">--kubeconfig</code> 플래그를 사용해 직접 명시할 수 있다.</p>\n<h3>How to use it (in deployment)</h3>\n<p>GitHub Actions를 이용해서 쿠버네티스에 배포를 하려면 마찬가지로 클러스터에 대한 접속 정보가 필요하기 때문에 이를 위해서 kubeconfig를 사용한다. 어떤 액션을 사용하는지는 자유겠지만, 나는 <a href=\"https://github.com/Azure/k8s-set-context\">k8s-set-context</a>라는 액션을 사용하기로 했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/220f47b321f97f4769bc00cd5375bb2f/bf286/k8s-set-context.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.58227848101266%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAv0lEQVQY05WQW2rDMBBFtYG+UiepbVkPy5ZkObEVQiHt/vd1itVS6F/zcbjDMByGK8ww48LCmDJ+vqCHxNNrzeNu4+1uRNUYVEq0/QnlM9Kd0CGj/Mq+sXdiEFVtGN5XhmvG5w/G9ZNuXIr4KB2Htv83m1TsDh0yBsw6Y+cr7nxjWG7YeEHaCWkjjfZlVi7RmvCL7Kci2p7a16ak2DrbelT9RKvHQmfDd/YRaQOdjWiXyo00/mcXeK4aHl6Of/gCbduGy+nmh28AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"k8s-set-context\"\n        title=\"k8s-set-context\"\n        src=\"/static/220f47b321f97f4769bc00cd5375bb2f/f058b/k8s-set-context.png\"\n        srcset=\"/static/220f47b321f97f4769bc00cd5375bb2f/c26ae/k8s-set-context.png 158w,\n/static/220f47b321f97f4769bc00cd5375bb2f/6bdcf/k8s-set-context.png 315w,\n/static/220f47b321f97f4769bc00cd5375bb2f/f058b/k8s-set-context.png 630w,\n/static/220f47b321f97f4769bc00cd5375bb2f/40601/k8s-set-context.png 945w,\n/static/220f47b321f97f4769bc00cd5375bb2f/78612/k8s-set-context.png 1260w,\n/static/220f47b321f97f4769bc00cd5375bb2f/bf286/k8s-set-context.png 1688w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>문서를 보면 kubeconfig 파일의 <strong>내용</strong>이 들어가야 한다고 적혀있다. 그런데, 이게 Azure의 쿠버네티스 클러스터 서비스인 AKS 내용만 있어서 구체적으로 어떤 내용이 들어가야 하는지 몰랐다.</p>\n<p>방법은 사실 허탈할 정도로 간단하다. 다음과 같이 kubeconfig 파일의 내용을 복사한 다음, GitHub 설정에 secret으로 등록하고 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cat ~/.kube/config | pbcopy</code></pre></div>\n<p>경우에 따라 base64 인코딩이 필요하기도 한데, 이럴 때는 쉘에 base64 유틸이 내장되어 있으니 이를 사용하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cat ~/.kube/config | base64 | pbcopy</code></pre></div>","frontmatter":{"title":"kubeconfig 정리","date":"2022-02-16","description":"뭐하는 녀석이냐!","category":"snippets","tags":["kubernetes","k8s","kubeconfig"]}},"previous":{"fields":{"slug":"/snippets/useful-git-recipes/"},"frontmatter":{"title":"유용한 Git 레시피 몇 가지"}},"next":{"fields":{"slug":"/source-set-in-kotlin-gradle-dsl/"},"frontmatter":{"title":"Gradle 프로젝트에 새로운 Source Set 추가하기 (with Kotlin Gradle DSL)"}}},"pageContext":{"id":"3027bfb9-fd38-5016-8a27-06a24a5952a5","previousPostId":"9acb6413-16ca-5a26-9c5a-0070e2b650c0","nextPostId":"31f1bd98-0582-50af-aac3-e09f56a24524"}},
    "staticQueryHashes": ["2841359383"]}