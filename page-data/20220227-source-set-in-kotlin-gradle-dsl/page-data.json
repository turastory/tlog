{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/20220227-source-set-in-kotlin-gradle-dsl/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Turastory"}},"markdownRemark":{"id":"41b02e3e-e7ad-5f5e-816e-bdd943abb75e","excerpt":"Gradle에서는 모듈 내에서도 소스셋을 나누어 사용할 수 있다. Intellij를 사용했을 때는 기본적으로는 다음과 같이 ,  두 가지의 source set…","html":"<p>Gradle에서는 모듈 내에서도 소스셋을 나누어 사용할 수 있다. Intellij를 사용했을 때는 기본적으로는 다음과 같이 <code class=\"language-text\">main</code>, <code class=\"language-text\">test</code> 두 가지의 source set이 디폴트로 주어지지만, 상황에 따라 여분의 소스셋을 추가하고 싶을 때도 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 296px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3887c410a71dde00686efefc185d78b5/b1a44/main-and-test.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.32911392405065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAADiUlEQVQ4y32TSW8bRxCF+TtyCpCccsjFkLjMvg855AxnuIkUSYmiSIqirN3W5lgK4izwJTF8CRDkmr/5Bd0CtZnJ4U119XS/6tf1OqfbLs1Ol6Kmc3h9x49//Ena6TEa7zLaneD4IUXNQDGsB5R081n+FDnx0SxHbqqkTdpbY7xKlVqSEtUzREHxT5AUVP2B7L9Ic+LHErrlUFBUrKBMszfAsyw5J0gNx8ULK6im/QXpU/LcciCq1+oZThASZy3u/voH6+Yjh8cnvLm45N37W37+9Tc6vU3yiiaJ//eEIhHSCpqBbpiU4hbfzK4wbBfNsHDDCpYXyHXriiZJ86r+OFY0yZNbddGyiKKhF/LsHr1ha36I5YeE1RpRXCdOG1TrGVGSkrbaMm+0O5iO90j4jFRGm6JhsTi/4vT2FzqbQ45Pz9iZTBlPZ+ztH7A53GayN2f/9aHMLdd/TvjyokuGRd50KRQV2RzhhrWSSlE3pVRxRcsmCYj8C0Ixabo+SaNFUdX5+voTX13+Tq07oD8Y0u0PpT8FLM8nqEQkWQPbC6QLVp5QtRzZgJJm8F1nh28HC/wko7vZJ2t1JFobPSlRWEqY3w3KEqsJTVtKFOM4SQnDKgXVYK2osF5SZXxVKEmrCUV5RZddLmoruryULE4hnuP1x8/8cHvGZjdj7+CIhWjA4kDG8WTGaDyRXt2d7q324fLdrpcUefG6W2GQFYlCFd0JCaIqQVSjXIulNwWCShWvHD1/KYJUTAov+bU6s+NzkjghihO8KCFKGlRqiZQspOZVjYJ2L1nk8p0bJrmSZiJQUHSCSoxhe0S1lLNPf7N2+5npbM7VzQ03796zNRqTL+kouiVR0iyW+5fImWWXe3jogY0eOlihQ7EW8f3ODLPiYQeB/K8FFppvyTUiGqEj5x85XHJ+u8wSQbuC1wqJejEbu13CxML7YGLdqXTmXbYXOwwX20xP9pgcz4h6Nbn+KUfOa4a8RNiOiPsZbrOMfaRjXii0pm1mx3O29keSeHw4kYXdRojfKkuIvSsJ/VblYUE67BN12lhpgJnYmHUXM3EwYhs783AaPnbqYWf+PeGS/WkVUbk7GxBkPlc/nXP54ZjRvMvi7RGvL444eHso4+x0LuUfXZ3IsZTspgEv4TfK+M2IcuIz6K8zXagMhiH1wQadUZfW9gYbOz2yQYt00KSz06O51cHLQv4Fgl0Ungq26OcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"main and test source sets\"\n        title=\"main and test source sets\"\n        src=\"/static/3887c410a71dde00686efefc185d78b5/b1a44/main-and-test.png\"\n        srcset=\"/static/3887c410a71dde00686efefc185d78b5/c26ae/main-and-test.png 158w,\n/static/3887c410a71dde00686efefc185d78b5/b1a44/main-and-test.png 296w\"\n        sizes=\"(max-width: 296px) 100vw, 296px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>나는 유닛 테스트와 통합 테스트를 서로 다른 소스셋으로 구분하고 싶어서 기존의 <code class=\"language-text\">test</code>는 그대로 둔 채로 <code class=\"language-text\">unitTest</code>라는 소스셋을 새로 추가했다. <code class=\"language-text\">build.gradle.kts</code>에서 아래와 같이 새로운 소스셋을 추가할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\"><span class=\"token comment\">// Create a new sourceSet for unitTests</span>\nsourceSets <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unitTest\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        java <span class=\"token punctuation\">{</span>\n            compileClasspath <span class=\"token operator\">+=</span> main<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compileClasspath <span class=\"token operator\">+</span> test<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>compileClasspath\n            runtimeClasspath <span class=\"token operator\">+=</span> main<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>runtimeClasspath <span class=\"token operator\">+</span> test<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>runtimeClasspath\n            <span class=\"token function\">srcDir</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"src/unitTest/kotlin\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 주목할 만한 부분은 <code class=\"language-text\">classpath</code>를 설정하는 부분이다. 기존에 테스트를 작성할 때는 별도의 설정 없이 <code class=\"language-text\">main</code> 소스셋의 클래스들을 가져다 사용할 수 있었다. 이는 <code class=\"language-text\">test</code> 소스셋에서 <code class=\"language-text\">main</code>의 클래스패스를 참조하기 때문에 그렇다. 마찬가지로 <code class=\"language-text\">unitTest</code>에서도 테스트를 위한 디펜던시들에 접근해야 하기 때문에 <code class=\"language-text\">test</code>의 클래스패스를 새로운 소스셋의 클래스패스에 추가해주었다.</p>\n<p>여기까지 작성했다면 IDE의 파일 트리에 새로운 소스셋이 추가된 것을 확인할 수 있다. 그런데 Intellij가 해당 소스셋을 테스트 소스셋으로 인식하지 않는다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 240px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ee932bae7df5ab08f5ed3abc5acf3dac/8ff5a/not-a-test-source-set.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 162.65822784810126%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAYAAADZPosTAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFgUlEQVRIx42WyXMbxxXG+Qfk5FQqx9ySlCupmJKwDgazDzDY930nSJAESADcRZFiJFGWLLOc2K4ohyhVcVWSS3LKwf/ez9VNgQWJZOzDV90z0/3Ne6/f+16vuF6SdK5AUFFpDreYP72k0hmg2y7im5fKYMU8wlEdRTN+FCuOlyRXquALhels7nD17p/Mn76kUm9ycHzCZHdGo90loKg/jTCkanKxsEA1bQw3jma7RHRDQiwynNgHFoo9i/nHlq8sf1B1E9Uwpfterki+3sZ144QiUUJRXf5YkBmOSzASvSFbJr0hFAu8dJZmpyfdH4xn/Om7/1A9e021O+Dzz19xeHzCsxcvOL/4IyenT4ia9m0LxYtlRHRTkiczeYobO/zs6/+hNfrUq1VavQGj7TGNdodqo4VmOZJE7JHjsoUfx0S47Q8phAybiGlLV1d9flb9QVZ9AVZ9QXwhBX848h4qvnDkwxh+PFcNC18gSGMw4vLbv7F1cCrDUq41bqFQrlJtNG9buEwoXPGHFQqNDmdffsv45IJSrSFjuHdwyNrGiPHulNneAd3BUMb4XpfFKGIp52oUJRgkHAgSNSziqYw8ceGycFPMg6om199p4XVqxHCTGZRQmM9KHX69dcof8g0sL4lm2vJAkpkcqWwe043LfaK67iQUfxIVVGm2Ufx+ftfd4ZO/fM8vzt5S6vQ5PDpiMp1xcHTM9mSXvcMjEuksphO7P4YifiKZlaiG33T5LFngoZclajmyvsXhiFoXP7bjnrRYHOL/JVzkpNiUTGXQdJtgRONBIMTDQIhHwfA1RCxDiozlvS67iRT1dpcHPj/t0YSrv/+LzemEXLHI+ua2POFOf8BgfUMmem9tne5g7f48FC7Y8QQBJUK6VGM02+OLyQOqJY96Z8BwYyQJBPrDdTr9NZmPN6W3ON2F8ii6Kef+9+mx+siHYSgEwmFZJcsVspgHlKW0EWTCTaGNwqr6YMTjl1/SaXXJF0tSNBLZAvlShXa3f1O/t/RwYaEItunEyeRLMtCtwYjzb97x6Z//S3ZtizevX/H02XOev7iU6aLqFmFVZIHxgbisqJaJhG2hmAZhXZPzqG2ixD1+dfCSYDKLaVyLr+46aI79fr0uEVlwWCYrbtnjA1Q8nFIcr5YiVU+T8FTcvoW1a2K1bBL1NLFyQq7JtHLkOgVilQROOS73r4gPyxAvraJLrl2kvzPEzCZw9izsf4TQvgjSnfY5vnjM7PGcx8+eMD/d5/jihFK/ilVw7yYUY7yalHCKHnbLwdo2sDcs0q0szVGH5qhNddigMqhRHtRINbNy372EYrSLMexSjFQ9T7pWxMl7mAUXNa2jpg2iGZNoxkDLmug5CzPv3EFY8qTp2XaB7vYALaPTmW7z/Ju3bB7vS9fWpyMGO0M62z05Njba9MYDiRVxCMuIVa8DLFwoDypo5STztsr4wuHqXGe4VWR8POfw4ojZ6fwaT/aYns5Zn49YMZIOC2ieRTRuyrmesFHsKGHXIJbQsdIRcvkIhqcTsFSClkrY0VBjBoqrS2gJixWRnAKh94mdSOcIhCOUmj3Gh2fUy1WihoNhJ7DiGfKlKvVmh+HGFtlCCd1y5VXGS2Vvl56QKdEzRF/ubU549e7fKFffUd4Y83pRKZeXnJ6dM9vf5+qrr2R/ef3mDb21oaz5e8VBt2z0dJ6fn/8VJVMk53mYtosVi8vL0+IyJeo/lkjJZ1l698mXFFjRJx494FE8w+8zVQK6daNCojnJ64totSHlpqHdSbgQ2FqnLzvdp/0pn7z9nl+efE2p3WM82ZECO9s/YHM8YbI7lW3h3q63EFjDiaMoER6mS/xmdMxvW9s4qSytTleqtLjyFStVyrW6FGMRsh8ArzDfHmOX38YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"does not recognize as test source set\"\n        title=\"does not recognize as test source set\"\n        src=\"/static/ee932bae7df5ab08f5ed3abc5acf3dac/8ff5a/not-a-test-source-set.png\"\n        srcset=\"/static/ee932bae7df5ab08f5ed3abc5acf3dac/c26ae/not-a-test-source-set.png 158w,\n/static/ee932bae7df5ab08f5ed3abc5acf3dac/8ff5a/not-a-test-source-set.png 240w\"\n        sizes=\"(max-width: 240px) 100vw, 240px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>이를 위해서는 idea 플러그인을 추가하고, <code class=\"language-text\">testSourceDirs</code>에 새로 추가한 소스셋을 등록하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"kotlin\"><pre class=\"language-kotlin\"><code class=\"language-kotlin\">plugins <span class=\"token punctuation\">{</span>\n    idea\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Register unitTest sourceSet as a test sourceSet.</span>\nidea<span class=\"token punctuation\">.</span><span class=\"token function\">module</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">val</span> testSources <span class=\"token operator\">=</span> testSourceDirs\n    testSources<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">.</span>sourceSets<span class=\"token punctuation\">.</span><span class=\"token function\">getByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unitTest\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>java<span class=\"token punctuation\">.</span>srcDirs<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// This line is redundant, but I just keep it as a reference.</span>\n    testSources<span class=\"token punctuation\">.</span><span class=\"token function\">addAll</span><span class=\"token punctuation\">(</span>project<span class=\"token punctuation\">.</span>sourceSets<span class=\"token punctuation\">.</span><span class=\"token function\">getByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"unitTest\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>resources<span class=\"token punctuation\">.</span>srcDirs<span class=\"token punctuation\">)</span>\n    testSourceDirs <span class=\"token operator\">=</span> testSources\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 206px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2d856a1952fed87dc596437c57520a77/a414c/test-source-set.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 175.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"recognize as test source set\"\n        title=\"recognize as test source set\"\n        src=\"/static/2d856a1952fed87dc596437c57520a77/a414c/test-source-set.png\"\n        srcset=\"/static/2d856a1952fed87dc596437c57520a77/c26ae/test-source-set.png 158w,\n/static/2d856a1952fed87dc596437c57520a77/a414c/test-source-set.png 206w\"\n        sizes=\"(max-width: 206px) 100vw, 206px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<hr>","frontmatter":{"title":"Gradle 프로젝트에 새로운 Source Set 추가하기 (with Kotlin Gradle DSL)","date":"February 27, 2022","description":null,"tags":["kotlin","gradle","intellij"]}},"previous":{"fields":{"slug":"/snippets/20220222-pandas-map-apply-applymap/"},"frontmatter":{"title":"Pandas map vs apply vs applymap"}},"next":null},"pageContext":{"id":"41b02e3e-e7ad-5f5e-816e-bdd943abb75e","previousPostId":"4162a083-fda3-5574-a196-686f84d4b24c","nextPostId":null}},
    "staticQueryHashes": ["2841359383"]}